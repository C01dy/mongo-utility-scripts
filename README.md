# MongoDB Utility Scripts

Этот проект содержит утилиты для работы с базой данных MongoDB. В проекте реализованы следующие основные скрипты:

- **findDuplicates.js**  
  Ищет дубликаты значений по заданным полям в коллекциях. Конфигурация (название коллекции и список полей) задаётся в файле, который вы формируете на основе ошибок создания индексов. Результаты для каждой коллекции сохраняются в виде отдельных JSON-файлов в каталоге `output/duplicaties_json/`.

  *Перед запуском необходимо положить в папку input файл updateIndex.failure.json (см. updateIndex.failure.example.json)*

- **findIndexes.js**  
  Проходит по всем коллекциям базы данных, определяет те, у которых количество индексов составляет 64 или более, и собирает статистику использования индексов с помощью `$indexStats`. Полученные данные (с количеством индексов и отсортированными по убыванию по полю `usageCount` индексами) сохраняются в виде JSON-файлов в каталоге `output/indexes_json/`.

- **generateConfigs.js**  
  Генерирует новый файл для поиска дубликатов.  
  Скрипт считывает входной файл с ошибками `input/updateIndex.failure.json`. Для каждого индекса, у которого обнаружена ошибка DuplicateKey (код 11000), из имени поля удаляется суффикс `"_1"`, и оно добавляется в список полей для соответствующей коллекции. Результат записывается в файл `output/duplicates_json/duplicateKeys.json`.

  *Перед запуском необходимо положить в папку input файл updateIndex.failure.json (см. updateIndex.failure.example.json)*

---

## Требования

- **[Bun](https://bun.sh)** – среда выполнения для JavaScript (скрипты запускаются через `bun run`).
- **MongoDB** – доступ к экземпляру базы данных.
- Пакеты: `mongodb`, `dotenv`  
  Устанавливаются командой:
  ```bash
  bun install
